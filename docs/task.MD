---
version: 1.4
lastUpdated: 2025-12-17
reviewedBy: Game Engineering Dept.
status: Approved
changelog: |
  - v1.4: AlineaciÃ³n estratÃ©gica completa. Sincronizados todos los documentos de anÃ¡lisis. AÃ±adidas tareas crÃ­ticas faltantes (Checkpoints, Combate, QA, Analytics). Re-priorizado el backlog y actualizado el roadmap a un modelo de 3 fases.
  - v1.3: AÃ±adido bloque meta YAML, resumen ejecutivo y campos de seguimiento.
---

# ğŸ“‹ Task.MD - Plan Maestro de EjecuciÃ³n Unificado
## Proyecto: Calamar Loco

**Ãšltima actualizaciÃ³n:** 17/12/2025
**VersiÃ³n:** 1.4
**Autoridad:** DecisiÃ³n conjunta de todos los Leads de Ã¡rea.

---

## 1. Objetivo General y Estrategia Unificada

**Calamar Loco** es un endless runner 3D con el objetivo de convertirse en un producto pulido, optimizado y con alta retenciÃ³n. Este plan unifica las directrices de todos los departamentos en una estrategia de tres fases:

1.  **ğŸš€ FASE 1: FUNDACIÃ“N (EstabilizaciÃ³n y MediciÃ³n).** El objetivo principal es lograr un **rendimiento estable y predecible en dispositivos mÃ³viles** y establecer la **infraestructura bÃ¡sica de calidad y datos**. No se aÃ±adirÃ¡n nuevas features de gameplay hasta que el juego sea estable y medible.
2.  **ğŸ¯ FASE 2: RETENCIÃ“N (DiversiÃ³n y Equidad).** Con una base sÃ³lida, el foco se mueve a **mejorar el core loop, balancear la dificultad y la economÃ­a, y optimizar la experiencia de usuario (UX)** para que los jugadores quieran volver.
3.  **ğŸŒŸ FASE 3: EXPANSIÃ“N (Profundidad y Contenido).** Una vez el juego es estable y divertido, se aÃ±adirÃ¡n **nuevos sistemas y contenido** para aumentar la profundidad y mantener el interÃ©s a largo plazo.

### ğŸ¯ DECISIÃ“N TÃ‰CNICA CONFIRMADA
**Framework evaluado y aprobado:** React Three Fiber (Three.js) es la tecnologÃ­a correcta y se mantendrÃ¡. El foco es la optimizaciÃ³n, no la migraciÃ³n.

## ğŸ” Resumen Ejecutivo (MÃ©tricas de Proyecto)

| MÃ©trica | Valor Actual | Fuente |
|----------|---------------|--------|
| Tareas totales | 24 | Task List Unificada |
| % completadas | 0 % | GitHub Project |
| FPS promedio mÃ³vil (Target) | â‰¥ 55 | Performance Benchmarks |
| TamaÃ±o de bundle (Target) | < 500 KB | Build Output |
| RetenciÃ³n D7 (North Star) | > 15% | Analytics Dashboard |
| Estado general | Inestable (En desarrollo activo) | CI/CD Metrics (Pendiente) |

---

## ğŸ¤– Plan Personal de IntegraciÃ³n de IA Ligera (Desarrollo Individual)

Este proyecto se desarrolla Ã­ntegramente por **una sola persona**.
Se incorporarÃ¡ un pequeÃ±o mÃ³dulo de **IA ligera** junto con **vibe coding** (asistentes de cÃ³digo IA, como Cline o Cursor) para acelerar prototipos y automatizar tareas repetitivas.

**PropÃ³sito:**
- Aplicar **Machine Learning ligero** dentro de un entorno web (React Three Fiber) sin backend.
- Mostrar dominio del flujo completo **IA â†’ Gameplay â†’ UX** en ejecuciÃ³n client-side (Vercel deploy).

**Lineamientos:**
1. Usar asistentes IA solo para boilerplate o tests rÃ¡pidos; la lÃ³gica central y evaluaciÃ³n son manuales.
2. Documentar experimentos en `/docs/AI_NOTES.md`.
3. Priorizar modelos client-side sin servidor ni almacenamiento externo.

**Implementaciones previstas:**
- **Adaptive AI Manager:** reglas locales que ajustan la dificultad segÃºn rendimiento.
- **Mini modelo TensorFlow.js:** red neuronal secuencial (3â†’3â†’1) entrenada en runtime para ajuste de dificultad en tiempo real.

---

## 2. Backlog de Tareas Unificado

### ğŸš€ FASE 1: FUNDACIÃ“N (EstabilizaciÃ³n y MediciÃ³n)

#### TASK-001: Implementar Object Pooling para Entidades
- **DescripciÃ³n:** Reutilizar instancias de obstÃ¡culos, gemas, etc., para eliminar la creaciÃ³n constante de objetos y los consecuentes picos de Garbage Collection (GC).
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-005: Optimizar GeometrÃ­as y Materiales (MemoizaciÃ³n)
- **DescripciÃ³n:** Auditar y asegurar que todas las geometrÃ­as y materiales se crean usando `useMemo` para evitar re-renders innecesarios.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-006: Implementar LOD (Level of Detail)
- **DescripciÃ³n:** Reducir la complejidad de los objetos lejanos para aligerar la carga en la GPU, especialmente en mÃ³viles.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** TASK-005

#### TASK-007: Optimizar Sistema de PartÃ­culas
- **DescripciÃ³n:** Reducir el `PARTICLE_COUNT` en dispositivos mÃ³viles y optimizar su shader para mejorar el fill-rate.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-010: Implementar Infraestructura de Testing
- **DescripciÃ³n:** Configurar `vitest` y escribir la primera suite de tests unitarios para la lÃ³gica de estado crÃ­tica en `store.ts`.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-011: Implementar Benchmarks de Performance
- **DescripciÃ³n:** Crear un sistema automatizado para medir FPS, uso de memoria y tiempos de carga en cada PR para prevenir regresiones.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** TASK-016

#### TASK-015: Implementar Analytics y TelemetrÃ­a BÃ¡sica
- **DescripciÃ³n:** Integrar un proveedor de analytics (ej. Plausible) y enviar los eventos fundamentales (session_start, game_start, death, level_complete).
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-016: Implementar Infraestructura de CI/CD
- **DescripciÃ³n:** Crear un pipeline bÃ¡sico en GitHub Actions que ejecute build, tests y type-checking en cada PR.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-018: Implementar MÃ¡quina de Estados de Juego (FSM)
- **DescripciÃ³n:** Refactorizar la gestiÃ³n de `GameStatus` en `store.ts` para usar una mÃ¡quina de estados finita que prevenga transiciones invÃ¡lidas (ej. `SHOP` y `PLAYING` al mismo tiempo).
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** Ninguna

#### TASK-020: Refactorizar Core Loop con Fixed Timestep
- **DescripciÃ³n:** Separar la lÃ³gica de fÃ­sica/gameplay de la lÃ³gica de render, implementando un loop de actualizaciÃ³n a timestep fijo para asegurar consistencia independientemente del framerate.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** TASK-001

---

### ğŸ¯ FASE 2: RETENCIÃ“N (DiversiÃ³n y Equidad)

#### TASK-003: DiseÃ±ar Patrones de Nivel Predefinidos
- **DescripciÃ³n:** Crear patrones de spawn prediseÃ±ados que incluyan "momentos de respiro" para mejorar el flow del juego y reducir la fatiga.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** TASK-001

#### TASK-017: Implementar Sistema de Checkpoints
- **DescripciÃ³n:** Guardar el progreso del jugador (letras, score) en puntos clave para que la muerte no signifique una pÃ©rdida total y frustrante.
- **Prioridad:** ğŸ”´ Alta
- **Dependencias:** TASK-018

#### TASK-019: Balance Inicial de EconomÃ­a y Dificultad
- **DescripciÃ³n:** Ajustar la curva de velocidad, el valor de las gemas y el coste de los upgrades en la tienda para reducir el grind y hacer la progresiÃ³n mÃ¡s satisfactoria.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** TASK-015 (para medir impacto)

#### TASK-022: Implementar Onboarding BÃ¡sico y Mejoras de UX
- **DescripciÃ³n:** AÃ±adir tooltips contextuales para el primer uso y aplicar mejoras de jerarquÃ­a y contraste en el HUD para facilitar la comprensiÃ³n inmediata del juego.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** Ninguna

#### TASK-002: Completar Sistema de Audio
- **DescripciÃ³n:** Expandir el sistema de audio con mÃºsica de fondo tropical, efectos de sonido variados y controles de volumen.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** Ninguna

---

### ğŸŒŸ FASE 3: EXPANSIÃ“N (Profundidad y Contenido)

#### TASK-021: Sistema de Combate (MVP)
- **DescripciÃ³n:** Implementar una mecÃ¡nica de disparo con municiÃ³n limitada para que el jugador tenga agencia ofensiva contra los enemigos.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** TASK-020

#### TASK-008: Implementar PWA (Progressive Web App)
- **DescripciÃ³n:** Agregar manifest.json y service worker para permitir que el juego se instale en dispositivos y tenga capacidades offline bÃ¡sicas.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** Ninguna

#### TASK-009: Configurar Build de ProducciÃ³n Optimizado
- **DescripciÃ³n:** Optimizar la configuraciÃ³n de Vite (code splitting, tree shaking, compresiÃ³n) para reducir el tamaÃ±o del bundle y los tiempos de carga.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** Ninguna

#### TASK-014: Implementar Sistema de Leaderboard
- **DescripciÃ³n:** Agregar una tabla de puntuaciones locales (localStorage) y un botÃ³n para compartir el score, fomentando la competitividad.
- **Prioridad:** ğŸŸ¢ Baja
- **Dependencias:** Ninguna

#### TASK-004: Agregar Haptic Feedback para MÃ³vil
- **DescripciÃ³n:** Implementar vibraciÃ³n del dispositivo para mejorar el feedback tÃ¡ctil en colisiones y recolecciones.
- **Prioridad:** ğŸŸ¢ Baja
- **Dependencias:** Ninguna

#### TASK-012: Documentar API del Store
- **DescripciÃ³n:** Documentar con JSDoc todas las acciones y el estado del store para facilitar el mantenimiento.
- **Prioridad:** ğŸŸ¢ Baja
- **Dependencias:** Ninguna

#### TASK-013: Crear GuÃ­a de ContribuciÃ³n
- **DescripciÃ³n:** Crear `CONTRIBUTING.md` con convenciones de cÃ³digo y procesos de PR.
- **Prioridad:** ğŸŸ¢ Baja
- **Dependencias:** Ninguna

#### TASK-023: Sistema de DocumentaciÃ³n Unificado
- **DescripciÃ³n:** Implementar la arquitectura de informaciÃ³n y las plantillas propuestas por el Technical Writer para mantener la coherencia documental.
- **Prioridad:** ğŸŸ¡ Media (Ongoing)
- **Dependencias:** Ninguna

#### TASK-024: IntegraciÃ³n de IA Ligera (Desarrollo Individual)
- **DescripciÃ³n:** Implementar una IA adaptativa local o modelo TensorFlow.js entrenado en el navegador para ajustar la dificultad o proveer feedback en tiempo real basado en datos del jugador. Utilizar *vibe coding* como soporte productivo.
- **Prioridad:** ğŸŸ¡ Media
- **Dependencias:** TASK-015 (Analytics / TelemetrÃ­a) y TASK-020 (Core Loop)
- **Subtareas:**
  1. Crear mÃ³dulo `AdaptiveAiManager.ts` con reglas adaptativas.
  2. Prototipar modelo TensorFlow.js simple (3â†’3â†’1) entrenado runtime.
  3. Integrar output de IA en la velocidad y HUD (`IA Confidence` display).
  4. Documentar proceso en `/docs/AI_NOTES.md` y README ("AI Edition").
  5. Publicar versiÃ³n demo **Calamar Loco AI Edition** en Vercel.

---

## 3. Roadmap de ImplementaciÃ³n Unificado

| Fase | Objetivo Principal | Tareas Clave | Criterio de Ã‰xito Principal |
|------|--------------------|--------------|-----------------------------|
| **1: FundaciÃ³n** (Semanas 1-4) | Estabilidad y MediciÃ³n | TASK-001, 005, 006, 007, 010, 011, 015, 016, 018, 020 | â‰¥ 55 FPS estables en mÃ³vil; Crash rate < 1%; Funnel de onboarding medible. |
| **2: RetenciÃ³n** (Semanas 5-8) | DiversiÃ³n y Equidad | TASK-017, 019, 022, 003, 002 | RetenciÃ³n D1 > 40%; Session Length > 5 minutos. |
| **3: ExpansiÃ³n** (Post Semana 8) | Profundidad y Contenido | TASK-021, 008, 009, 014, 004 y resto del backlog | RetenciÃ³n D7 > 15%; MÃ©tricas de uso de nuevas features > 30%. |

---

## 4. MÃ©tricas de Ã‰xito del Proyecto (Alineadas)

| MÃ©trica | Target | CÃ³mo Medir | Fase Relevante |
|---------|--------|------------|----------------|
| FPS en mÃ³vil (p95) | â‰¥ 55 FPS | Performance Benchmarks (TASK-011) | 1 |
| Crash-free Sessions | > 99% | Error Tracking (Sentry/Similar) | 1 |
| Tiempo de Carga (TTI) | < 3 segundos | Lighthouse / CI (TASK-016) | 1 |
| RetenciÃ³n D1 | > 40% | Analytics (TASK-015) | 2 |
| Session Length Promedio | > 8 minutos | Analytics (TASK-015) | 2 y 3 |
| **RetenciÃ³n D7 (North Star)** | **> 15%** | **Analytics (TASK-015)** | **3** |
| Feature Usage (Combate) | > 30% | Analytics (TASK-015) | 3 |

---
---
**PrÃ³ximos pasos personales:**
- Iniciar la rama `feature/ai-demo`.
- Documentar avances en `/docs/AI_NOTES.md`.
- Iterar el mÃ³dulo de IA ligera hasta obtener una demo funcional en Vercel.
---

*Este documento ahora sirve como la Ãºnica fuente de verdad para la planificaciÃ³n y priorizaciÃ³n del proyecto. Todos los demÃ¡s documentos de anÃ¡lisis deben referirse a este plan.*

